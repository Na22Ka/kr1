// Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‚ĞµĞ¼Ğ°Ğ¼Ğ¸ Ğ¸ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸ÑĞ¼Ğ¸
class ThemeManager {
    constructor() {
        this.currentTheme = localStorage.getItem('theme') || 'light';
        this.init();
    }

    init() {
        this.applyTheme(this.currentTheme);
        this.createThemeSwitcher();
        this.addGoodsCardInteractions();
    }

    applyTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        this.currentTheme = theme;
    }

    toggleTheme() {
        const newTheme = this.currentTheme === 'light' ? 'dark' : 'light';
        this.applyTheme(newTheme);
        
        // ĞĞ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
        document.documentElement.style.transition = 'all 0.3s ease';
        setTimeout(() => {
            document.documentElement.style.transition = '';
        }, 300);
    }

    createThemeSwitcher() {
        const switcher = document.createElement('div');
        switcher.className = 'theme-switcher';
        switcher.innerHTML = `
            <button class="theme-toggle" title="ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ñ‚ĞµĞ¼Ñƒ">
                ${this.currentTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸'}
            </button>
        `;

        document.body.appendChild(switcher);

        switcher.querySelector('.theme-toggle').addEventListener('click', () => {
            this.toggleTheme();
            this.updateThemeButton();
        });
    }

    updateThemeButton() {
        const button = document.querySelector('.theme-toggle');
        if (button) {
            button.textContent = this.currentTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
        }
    }

    addGoodsCardInteractions() {
        document.addEventListener('click', (e) => {
            // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° ĞºĞ½Ğ¾Ğ¿Ğ¾Ğº "Ğ’ ĞºĞ¾Ñ€Ğ·Ğ¸Ğ½Ñƒ"
            if (e.target.classList.contains('goods-button')) {
                this.handleGoodsButtonClick(e.target);
            }

            // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° ĞºĞ»Ğ¸ĞºĞ° Ğ¿Ğ¾ ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞµ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ°
            const goodsCard = e.target.closest('.goods-card');
            if (goodsCard && !e.target.classList.contains('goods-button')) {
                this.toggleGoodsCardSelection(goodsCard);
            }
        });
    }

    handleGoodsButtonClick(button) {
        const card = button.closest('.goods-card');
        const productName = card.querySelector('.goods-name').textContent;
        
        // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ
        button.classList.add('goods-button--added');
        button.textContent = 'âœ“ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¾';
        
        // Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ¸ÑÑ…Ğ¾Ğ´Ğ½Ğ¾Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ñ‡ĞµÑ€ĞµĞ· 2 ÑĞµĞºÑƒĞ½Ğ´Ñ‹
        setTimeout(() => {
            button.classList.remove('goods-button--added');
            button.textContent = 'Ğ’ ĞºĞ¾Ñ€Ğ·Ğ¸Ğ½Ñƒ';
        }, 2000);

        // ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ
        this.showNotification(`Ğ¢Ğ¾Ğ²Ğ°Ñ€ "${productName}" Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ Ğ² ĞºĞ¾Ñ€Ğ·Ğ¸Ğ½Ñƒ`);
    }

    toggleGoodsCardSelection(card) {
        card.classList.toggle('goods-card--selected');
        
        if (card.classList.contains('goods-card--selected')) {
            this.showNotification('Ğ¢Ğ¾Ğ²Ğ°Ñ€ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ Ğ² Ğ¸Ğ·Ğ±Ñ€Ğ°Ğ½Ğ½Ğ¾Ğµ');
        }
    }

    showNotification(message) {
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--color-primary);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            max-width: 300px;
        `;
        notification.textContent = message;

        document.body.appendChild(notification);

        // ĞĞ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ÑĞ²Ğ»ĞµĞ½Ğ¸Ñ
        setTimeout(() => {
            notification.style.transform = 'translateX(0)';
        }, 100);

        // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ
        setTimeout(() => {
            notification.style.transform = 'translateX(100%)';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }
}

// Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹
document.addEventListener('DOMContentLoaded', () => {
    new ThemeManager();
    
    // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ÑĞ²Ğ»ĞµĞ½Ğ¸Ñ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
    const animatedElements = document.querySelectorAll('.profile-card, .goods-card, .news-card, .project-card');
    animatedElements.forEach((el, index) => {
        el.style.animationDelay = `${index * 0.1}s`;
        el.classList.add('fade-in');
    });
});